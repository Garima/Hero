{"version":3,"file":"rating.component.js","sourceRoot":"","sources":["../../.tmp/rating/rating.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, HostListener, Input, OnInit, Output, forwardRef } from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\n\r\nexport const RATING_CONTROL_VALUE_ACCESSOR: any = {\r\n  provide: NG_VALUE_ACCESSOR,\r\n  useExisting: forwardRef(() => RatingComponent),\r\n  multi: true\r\n};\r\n\r\n@Component({\r\n  selector: 'rating',\r\n  template: `\r\n    <span (mouseleave)=\"reset()\" (keydown)=\"onKeydown($event)\" tabindex=\"0\" role=\"slider\" aria-valuemin=\"0\" [attr.aria-valuemax]=\"range.length\" [attr.aria-valuenow]=\"value\">\r\n      <template ngFor let-r [ngForOf]=\"range\" let-index=\"index\">\r\n        <span class=\"sr-only\">({{ index < value ? '*' : ' ' }})</span>\r\n        <i (mouseenter)=\"enter(index + 1)\" (click)=\"rate(index + 1)\" class=\"glyphicon\" [ngClass]=\"index < value ? r.stateOn : r.stateOff\" [title]=\"r.title\" ></i>\r\n      </template>\r\n    </span>\r\n  `,\r\n  providers: [RATING_CONTROL_VALUE_ACCESSOR]\r\n})\r\nexport class RatingComponent implements ControlValueAccessor, OnInit {\r\n  /** number of icons */\r\n  @Input() public max: number = 5;\r\n  /** selected icon class */\r\n  @Input() public stateOn: string;\r\n  /** unselected icon class */\r\n  @Input() public stateOff: string;\r\n  /** if true will not react on any user events */\r\n  @Input() public readonly: boolean;\r\n  /** array of icons titles, default: ([\"one\", \"two\", \"three\", \"four\", \"five\"]) */\r\n  @Input() public titles: string[];\r\n  /** array of custom icons classes */\r\n  @Input() public ratingStates: {stateOn: string, stateOff: string}[];\r\n  /** fired when icon selected, $event:number equals to selected rating */\r\n  @Output() public onHover: EventEmitter<number> = new EventEmitter();\r\n  /** fired when icon selected, $event:number equals to previous rating value */\r\n  @Output() public onLeave: EventEmitter<number> = new EventEmitter();\r\n\r\n  public onChange: any = Function.prototype;\r\n  public onTouched: any = Function.prototype;\r\n\r\n  public range: any[];\r\n  public value: number;\r\n  protected preValue: number;\r\n\r\n  @HostListener('keydown', ['$event'])\r\n  public onKeydown(event: any): void {\r\n    if ([37, 38, 39, 40].indexOf(event.which) === -1) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    let sign = event.which === 38 || event.which === 39 ? 1 : -1;\r\n    this.rate(this.value + sign);\r\n  }\r\n\r\n  public ngOnInit(): void {\r\n    this.max = typeof this.max !== 'undefined' ? this.max : 5;\r\n    this.readonly = this.readonly === true;\r\n    this.stateOn = typeof this.stateOn !== 'undefined'\r\n      ? this.stateOn\r\n      : 'glyphicon-star';\r\n    this.stateOff = typeof this.stateOff !== 'undefined'\r\n      ? this.stateOff\r\n      : 'glyphicon-star-empty';\r\n    this.titles = typeof this.titles !== 'undefined' && this.titles.length > 0\r\n      ? this.titles\r\n      : ['one', 'two', 'three', 'four', 'five'];\r\n    this.range = this.buildTemplateObjects(this.ratingStates, this.max);\r\n  }\r\n\r\n  // model -> view\r\n  public writeValue(value: number): void {\r\n    if (value % 1 !== value) {\r\n      this.value = Math.round(value);\r\n      this.preValue = value;\r\n      return;\r\n    }\r\n\r\n    this.preValue = value;\r\n    this.value = value;\r\n  }\r\n\r\n  public enter(value: number): void {\r\n    if (!this.readonly) {\r\n      this.value = value;\r\n      this.onHover.emit(value);\r\n    }\r\n  }\r\n\r\n  public reset(): void {\r\n    this.value = this.preValue;\r\n    this.onLeave.emit(this.value);\r\n  }\r\n\r\n  public registerOnChange(fn: (_: any) => {}): void {\r\n    this.onChange = fn;\r\n  }\r\n\r\n  public registerOnTouched(fn: () => {}): void {\r\n    this.onTouched = fn;\r\n  }\r\n\r\n  public rate(value: number): void {\r\n    if (!this.readonly && value >= 0 && value <= this.range.length) {\r\n      this.writeValue(value);\r\n      this.onChange(value);\r\n    }\r\n  }\r\n\r\n  protected buildTemplateObjects(ratingStates: any[], max: number): any[] {\r\n    ratingStates = ratingStates || [];\r\n    let count = ratingStates.length || max;\r\n    let result: any[] = [];\r\n    for (let i = 0; i < count; i++) {\r\n      result.push(Object.assign({\r\n        index: i,\r\n        stateOn: this.stateOn,\r\n        stateOff: this.stateOff,\r\n        title: this.titles[i] || i + 1\r\n      }, ratingStates[i] || {}));\r\n    }\r\n    return result;\r\n  }\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}