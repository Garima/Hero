{"version":3,"file":"flag-month-view.js","sourceRoot":"","sources":["../../../.tmp/datepicker/engine/flag-month-view.ts"],"names":[],"mappings":"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","sourcesContent":["import { DayViewModel, MonthViewModel, WeekViewModel } from '../models/index';\r\nimport { isSameMonth } from '../../bs-moment/utils/date-getters';\r\n\r\nexport interface FlagMonthViewOptions {\r\n  hoveredDate: Date;\r\n  selectedDate: Date;\r\n  selectedRange: Date[];\r\n  displayMonths: number;\r\n  monthIndex: number;\r\n}\r\n\r\nexport function flagMonthView(formattedMonth: MonthViewModel,\r\n                              options: FlagMonthViewOptions): MonthViewModel {\r\n  formattedMonth.weeks\r\n    .forEach((week: WeekViewModel, weekIndex: number) => {\r\n      week.days.forEach((day: DayViewModel, dayIndex: number) => {\r\n        // datepicker\r\n        const isOtherMonth = !isSameMonth(day.date, formattedMonth.month);\r\n\r\n        const isHovered = !isOtherMonth && isSameDate(day.date, options.hoveredDate);\r\n        // date range picker\r\n        const isSelectionStart = !isOtherMonth && isSameDate(day.date, options.selectedRange[0]);\r\n        const isSelectionEnd = !isOtherMonth && isSameDate(day.date, options.selectedRange[1]);\r\n\r\n        const isSelected = !isOtherMonth && isSameDate(day.date, options.selectedDate) ||\r\n          isSelectionStart || isSelectionEnd;\r\n\r\n        const isInRange = !isOtherMonth && isDateInRange(day.date, options.selectedRange, options.hoveredDate);\r\n        // decide update or not\r\n        const newDay = Object.assign(/*{},*/ day, {\r\n          isOtherMonth,\r\n          isHovered,\r\n          isSelected,\r\n          isSelectionStart,\r\n          isSelectionEnd,\r\n          isInRange\r\n        });\r\n\r\n        if (day.isOtherMonth !== newDay.isOtherMonth ||\r\n          day.isHovered !== newDay.isHovered ||\r\n          day.isSelected !== newDay.isSelected ||\r\n          day.isSelectionStart !== newDay.isSelectionStart ||\r\n          day.isSelectionEnd !== newDay.isSelectionEnd ||\r\n          day.isInRange !== newDay.isInRange) {\r\n          week.days[dayIndex] = newDay;\r\n        }\r\n      });\r\n    });\r\n\r\n  // todo: add check for linked calendars\r\n  formattedMonth.hideLeftArrow = options.monthIndex > 0\r\n    && options.monthIndex !== options.displayMonths;\r\n  formattedMonth.hideRightArrow = options.monthIndex < options.displayMonths\r\n    && (options.monthIndex + 1) !== options.displayMonths;\r\n  return formattedMonth;\r\n}\r\n\r\nfunction isSameDate(date: Date, selectedDate: Date): boolean {\r\n  if (!date || !selectedDate) {\r\n    return false;\r\n  }\r\n\r\n  return date.getFullYear() === selectedDate.getFullYear()\r\n    && date.getMonth() === selectedDate.getMonth()\r\n    && date.getDate() === selectedDate.getDate();\r\n}\r\n\r\nfunction isDateInRange(date: Date, selectedRange: Date[], hoveredDate: Date): boolean {\r\n  if (!date || !selectedRange[0]) {\r\n    return false;\r\n  }\r\n\r\n  if (selectedRange[1]) {\r\n    return date > selectedRange[0] && date <= selectedRange[1];\r\n  }\r\n\r\n  if (hoveredDate) {\r\n    return date > selectedRange[0] && date <= hoveredDate;\r\n  }\r\n\r\n  return false;\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}