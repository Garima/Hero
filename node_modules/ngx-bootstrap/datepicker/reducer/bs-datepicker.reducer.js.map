{"version":3,"file":"bs-datepicker.reducer.js","sourceRoot":"","sources":["../../../.tmp/datepicker/reducer/bs-datepicker.reducer.ts"],"names":[],"mappings":"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","sourcesContent":["import { BsDatepickerState, initialDatepickerState } from './bs-datepicker.state';\r\nimport { Action } from '../../mini-ngrx/index';\r\nimport { BsDatepickerActions } from './bs-datepicker.actions';\r\nimport { calculateMonthModel } from '../engine/calc-month-view';\r\nimport { formatMonthView } from '../engine/format-month-view';\r\nimport { flagMonthView } from '../engine/flag-month-view';\r\nimport { shiftDate } from '../../bs-moment/utils/date-setters';\r\n\r\nexport function bsDatepickerReducer(state = initialDatepickerState, action: Action): BsDatepickerState {\r\n  switch (action.type) {\r\n/*\r\n    case (BsDatepickerActions.INIT): {\r\n      const locale = getLocale(state.formatOptions.locale);\r\n      const monthViewOptions = Object.assign({}, state.monthViewOptions, {firstDayOfWeek: locale.firstDayOfWeek()});\r\n      const monthModel = calculateMonthModel(state.viewDate, monthViewOptions);\r\n      return Object.assign({}, state, {locale, monthViewOptions, monthModel});\r\n    }\r\n*/\r\n\r\n    case (BsDatepickerActions.CALCULATE): {\r\n      const displayMonths = state.renderOptions.displayMonths;\r\n      const monthsModel = new Array(displayMonths);\r\n      let viewDate = state.viewDate;\r\n\r\n      for (let monthIndex = 0; monthIndex < displayMonths; monthIndex++) {\r\n        // todo: for unlinked calendars it will be harder\r\n         monthsModel[monthIndex] = calculateMonthModel(viewDate, state.monthViewOptions);\r\n         viewDate = shiftDate(viewDate, {month: 1});\r\n      }\r\n      return Object.assign({}, state, {monthsModel});\r\n    }\r\n\r\n    case (BsDatepickerActions.FORMAT): {\r\n      const formattedMonths = state.monthsModel\r\n        .map((month, monthIndex) => formatMonthView(month, state.formatOptions, monthIndex));\r\n      return Object.assign({}, state, {formattedMonths});\r\n    }\r\n\r\n    case (BsDatepickerActions.FLAG): {\r\n      const flaggedMonths = state.formattedMonths\r\n        .map((formattedMonth, monthIndex) => flagMonthView(formattedMonth, {\r\n          hoveredDate: state.hoveredDate,\r\n          selectedDate: state.selectedDate,\r\n          selectedRange: state.selectedRange,\r\n          displayMonths: state.renderOptions.displayMonths,\r\n          monthIndex\r\n        }));\r\n      return Object.assign({}, state, {flaggedMonths});\r\n    }\r\n\r\n    case(BsDatepickerActions.STEP_NAVIGATION): {\r\n      const viewDate = shiftDate(state.viewDate, action.payload);\r\n      return Object.assign({}, state, {viewDate});\r\n    }\r\n\r\n    case(BsDatepickerActions.HOVER): {\r\n      return Object.assign({}, state, {hoveredDate: action.payload});\r\n    }\r\n\r\n    case(BsDatepickerActions.SELECT): {\r\n      return Object.assign({}, state, {selectedDate: action.payload});\r\n    }\r\n\r\n    case(BsDatepickerActions.RENDER_OPTIONS): {\r\n      return Object.assign({}, state, {renderOptions: action.payload});\r\n    }\r\n\r\n    // date range picker\r\n    case(BsDatepickerActions.SELECT_RANGE): {\r\n      return Object.assign({}, state, {selectedRange: action.payload});\r\n    }\r\n\r\n    default: return state;\r\n  }\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}